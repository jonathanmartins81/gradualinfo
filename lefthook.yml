# Lefthook - Git Hooks para Qualidade de CÃ³digo
# https://github.com/evilmartians/lefthook
#
# Este arquivo configura hooks do Git para garantir qualidade de cÃ³digo
# antes de commits e pushes.

# Hooks executados antes do commit
pre-commit:
  parallel: true
  commands:
    # FormataÃ§Ã£o com Prettier
    format:
      glob: '*.{js,jsx,ts,tsx,json,css,md,yml,yaml}'
      run: npx prettier --write {staged_files}

    # Linting com ESLint
    lint:
      glob: '*.{js,jsx,ts,tsx}'
      run: npx eslint --fix {staged_files}

    # VerificaÃ§Ã£o de tipos TypeScript
    type-check:
      glob: '*.{ts,tsx}'
      run: npx tsc --noEmit

    # VerificaÃ§Ã£o de dependÃªncias nÃ£o utilizadas
    check-deps:
      run: npx knip --reporter=json

    # Testes unitÃ¡rios para arquivos alterados
    test:
      glob: '*.{js,jsx,ts,tsx}'
      run: npx vitest run --reporter=verbose {staged_files}

# Hooks executados antes do push
pre-push:
  parallel: false
  commands:
    # VerificaÃ§Ã£o completa de qualidade
    quality-full:
      run: npm run quality:full

    # Build de produÃ§Ã£o
    build:
      run: npm run build

    # VerificaÃ§Ã£o de vulnerabilidades
    audit:
      run: npm audit --audit-level=moderate

# Hooks executados apÃ³s o commit
post-commit:
  commands:
    # RelatÃ³rio de qualidade
    quality-report:
      run: |
        echo "ğŸ‰ Commit realizado com sucesso!"
        echo "âœ… CÃ³digo formatado e validado"
        echo "ğŸ§ª Testes executados"
        echo "ğŸ” DependÃªncias verificadas"
        echo "ğŸ“Š Qualidade garantida"

# Hooks executados apÃ³s o merge
post-merge:
  commands:
    # Instalar dependÃªncias apÃ³s merge
    install:
      run: npm install

    # Verificar se tudo estÃ¡ funcionando
    verify:
      run: npm run quality
